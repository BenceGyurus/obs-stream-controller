version: '3.8'

services:
  obs-stream-control:
    image: ghcr.io/YOUR_USERNAME/obs-stream-control:latest
    # Ha helyben build-eled:
    # build: .
    container_name: obs-stream-control
    restart: always
    ports:
      - "8000:8000"
    environment:
      # YouTube API beállítások
      - YOUTUBE_API_KEY=${YOUTUBE_API_KEY}
      - YOUTUBE_CHANNEL_ID=${YOUTUBE_CHANNEL_ID}
      - YOUTUBE_CLIENT_SECRET_FILE=/app/client_secret.json
      - YOUTUBE_BROADCAST_ID=${YOUTUBE_BROADCAST_ID:-}
      - YOUTUBE_BROADCAST_RESET=${YOUTUBE_BROADCAST_RESET:-false}
      
      # OAuth Headless Mode (FONTOS Synology NAS-hoz!)
      # Ez engedélyezi a böngésző nélküli hitelesítést
      - OAUTH_HEADLESS=true
      
      # OBS WebSocket beállítások
      # FONTOS: Synology NAS-on használd a valódi IP címet
      # Pl: - OBS_WEBSOCKET_HOST=192.168.1.100
      - OBS_WEBSOCKET_HOST=${OBS_WEBSOCKET_HOST:-192.168.1.1}
      - OBS_WEBSOCKET_PORT=${OBS_WEBSOCKET_PORT:-4455}
      - OBS_WEBSOCKET_PASSWORD=${OBS_WEBSOCKET_PASSWORD}
    
    volumes:
      # OAuth credentials fájlok
      # Synology-n használj abszolút útvonalakat, pl:
      # - /volume1/docker/obs-stream-control/client_secret.json:/app/client_secret.json:ro
      - ./client_secret.json:/app/client_secret.json:ro
      - ./token.json:/app/token.json
    
    # Synology NAS - network_mode host használata az OBS eléréséhez
    # Ha az OBS ugyanazon a gépen fut mint a NAS, használd ezt:
    # network_mode: host
    # FIGYELEM: Ha network_mode: host -ot használsz, töröld a ports szekciót!
    
    # Resource limitek (opcionális - ha problémát okoz, töröld)
    mem_limit: 512m
    
    # Logging konfiguráció
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
